<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humankind Alpha - NDA</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Sora (to match your main page) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Copied directly from your main index.html for a consistent theme */
        :root {
            --primary-color: #D98236; /* Muted Orange for main buttons */
            --primary-hover-color: #D95E32; /* Brighter Custom Orange for hover */
            --primary-ring-color: #FDBA74;
        }
        body {
            font-family: 'Sora', sans-serif;
            background-color: #F9FAFB; /* Light gray background */
            color: #1F2937; /* Dark text color */
        }
        .modern-btn {
            background: linear-gradient(to right, var(--primary-color), var(--primary-hover-color));
            transition: all 0.3s ease;
        }
        .modern-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -10px var(--primary-color);
        }
        /* Custom scrollbar for a cleaner look */
        .nda-text::-webkit-scrollbar {
            width: 8px;
        }
        .nda-text::-webkit-scrollbar-track {
            background: #E5E7EB; /* gray-200 */
        }
        .nda-text::-webkit-scrollbar-thumb {
            background: #9CA3AF; /* gray-400 */
            border-radius: 4px;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 flex items-center justify-center min-h-screen p-4 sm:p-6">

    <div class="w-full max-w-2xl bg-white rounded-2xl shadow-xl p-6 sm:p-8 space-y-6">
        <!-- Header -->
        <div class="text-center">
            <img src="/logo.png" alt="HumanKind Logo" class="h-12 w-12 mx-auto mb-2" onerror="this.style.display='none'">
            <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">Alpha Tester NDA</h1>
            <p class="text-gray-600 mt-2">Please read and agree to the terms to continue.</p>
        </div>

        <!-- NDA Text Box -->
        <div id="nda-text" class="nda-text h-64 overflow-y-scroll border border-gray-300 rounded-lg p-4 bg-gray-50 text-gray-700 text-sm">
            <h2 class="font-bold text-lg mb-2 text-gray-800">1. Confidential Information</h2>
            <p class="mb-4">You agree that all information disclosed to you during the alpha testing of the Humankind app, including but not to, features, design, user interface, business plans, and performance metrics ("Confidential Information") is the proprietary and confidential property of Humankind Inc. You shall not disclose this Confidential Information to any third party.</p>
            <h2 class="font-bold text-lg mb-2 text-gray-800">2. Use of Information</h2>
            <p class="mb-4">You agree to use the Confidential Information solely for the purpose of testing and providing feedback on the Humankind app. Any other use, copying, or distribution of the Confidential Information is strictly prohibited.</p>
            <h2 class="font-bold text-lg mb-2 text-gray-800">3. Feedback</h2>
            <p class="mb-4">You agree to provide honest and constructive feedback regarding your experience with the app. All feedback, ideas, and suggestions you provide become the exclusive property of Humankind Inc., without any obligation of compensation to you.</p>
            <h2 class="font-bold text-lg mb-2 text-gray-800">4. Term</h2>
            <p class="mb-4">This agreement is effective as of the date of your acceptance and will continue until the official public launch of the Humankind app, or until terminated in writing by Humankind Inc.</p>
            <h2 class="font-bold text-lg mb-2 text-gray-800">5. No Warranty</h2>
            <p class="mb-4">The alpha version of the Humankind app is provided "as-is." Humankind Inc. makes no warranties, express or implied, regarding the app's functionality, reliability, or suitability for any purpose.</p>
             <h2 class="font-bold text-lg mb-2 text-gray-800">6. Acknowledgment</h2>
            <p>By checking the box and submitting this form, you acknowledge that you have read, understood, and agree to be bound by the terms and conditions of this Non-Disclosure Agreement.</p>
        </div>

        <!-- Form for User Details -->
        <form id="nda-form" class="space-y-4">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div>
                    <label for="firstName" class="block text-sm font-medium text-gray-700">First Name</label>
                    <input type="text" id="firstName" name="firstName" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[var(--primary-ring-color)] focus:border-[var(--primary-color)] sm:text-sm">
                </div>
                <div>
                    <label for="lastName" class="block text-sm font-medium text-gray-700">Last Name</label>
                    <input type="text" id="lastName" name="lastName" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[var(--primary-ring-color)] focus:border-[var(--primary-color)] sm:text-sm">
                </div>
            </div>
            <div>
                <label for="email" class="block text-sm font-medium text-gray-700">Email Address</label>
                <input type="email" id="email" name="email" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[var(--primary-ring-color)] focus:border-[var(--primary-color)] sm:text-sm">
            </div>

            <!-- Agreement Checkbox -->
            <div class="flex items-center space-x-3">
                <input id="agree-checkbox" name="agreement" type="checkbox" disabled class="h-4 w-4 rounded border-gray-300 text-[var(--primary-color)] focus:ring-[var(--primary-color)] disabled:opacity-50 disabled:cursor-not-allowed">
                <label for="agree-checkbox" id="agree-label" class="font-medium text-gray-500">Scroll to the bottom to agree to the NDA.</label>
            </div>

            <!-- Submit Button -->
            <button type="submit" id="submit-button" disabled class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-semibold text-white modern-btn disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none disabled:transform-none">
                Agree and Continue
            </button>
        </form>
    </div>

    <script type="module">
        // =========================================================================
        // Firebase SDK and Configuration
        // =========================================================================
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // IMPORTANT: Replace this with your web app's Firebase configuration.
        const firebaseConfig = {
          apiKey: "AIzaSyDUNd7fekWmk-IPCHwxEz3gxWU4pBNecqI",
          authDomain: "humankind-email-collection.firebaseapp.com",
          projectId: "humankind-email-collection",
          storageBucket: "humankind-email-collection.firebasestorage.app",
          messagingSenderId: "1031378804643",
          appId: "1:1031378804643:web:0e619c76d7185a95f88416",
          measurementId: "G-WK35RNPXKM"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // =========================================================================
        // Page Logic
        // =========================================================================
        const ndaText = document.getElementById('nda-text');
        const agreeCheckbox = document.getElementById('agree-checkbox');
        const agreeLabel = document.getElementById('agree-label');
        const submitButton = document.getElementById('submit-button');
        const form = document.getElementById('nda-form');
        const firstNameInput = document.getElementById('firstName');
        const lastNameInput = document.getElementById('lastName');
        const emailInput = document.getElementById('email');

        function validateForm() {
            const isFirstNameValid = firstNameInput.value.trim() !== '';
            const isLastNameValid = lastNameInput.value.trim() !== '';
            const isEmailValid = emailInput.checkValidity();
            const isCheckboxChecked = agreeCheckbox.checked;

            if (isFirstNameValid && isLastNameValid && isEmailValid && isCheckboxChecked) {
                submitButton.disabled = false;
            } else {
                submitButton.disabled = true;
            }
        }

        ndaText.addEventListener('scroll', () => {
            const isScrolledToBottom = ndaText.scrollHeight - ndaText.scrollTop <= ndaText.clientHeight + 5;
            if (isScrolledToBottom) {
                agreeCheckbox.disabled = false;
                agreeLabel.classList.remove('text-gray-500');
                agreeLabel.classList.add('text-gray-700');
                agreeLabel.textContent = 'I have read and agree to the NDA.';
            }
        });

        [firstNameInput, lastNameInput, emailInput, agreeCheckbox].forEach(element => {
            element.addEventListener('input', validateForm);
        });

        // Event listener for form submission
        form.addEventListener('submit', async (event) => {
            event.preventDefault(); 
            if (submitButton.disabled) return;

            // Disable button to prevent multiple submissions
            submitButton.disabled = true;
            submitButton.textContent = 'Submitting...';

            try {
                // Add a new document with the user's details to the "alpha_testers" collection
                await addDoc(collection(db, "alpha_testers"), {
                    firstName: firstNameInput.value.trim(),
                    lastName: lastNameInput.value.trim(),
                    email: emailInput.value.trim(),
                    agreedAt: serverTimestamp()
                });

                // If successful, redirect to the instructions page
                window.location.href = '/alpha/instructions';

            } catch (error) {
                console.error("Error adding document to Firebase: ", error);
                // Re-enable the button and inform the user if there was an error
                submitButton.disabled = false;
                submitButton.textContent = 'An error occurred. Please try again.';
                // You could also show a more user-friendly error message on the page
            }
        });
    </script>
</body>
</html>
